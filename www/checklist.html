<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checklist Manutenção Predial</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --success: #27ae60;
            --danger: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 10px;
            background-color: var(--light);
            font-size: 14px;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: var(--primary);
            font-size: 1.5em;
            margin: 15px 0;
        }

        .filters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 5px;
            margin-bottom: 10px;
        }

        select, button {
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #ddd;
            width: 100%;
        }

        button {
            background-color: var(--secondary);
            color: white;
            border: none;
            cursor: pointer;
            transition: opacity 0.3s;
        }

        button:active {
            opacity: 0.8;
        }

        .item {
            background: white;
            margin-bottom: 8px;
            padding: 12px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            border-left: 4px solid #ddd;
        }

        .item.completed {
            border-left-color: var(--success);
            background-color: #f8fff8;
        }

        .item.overdue {
            border-left-color: var(--danger);
            background-color: #fff5f5;
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .item-id {
            font-weight: bold;
            color: var(--primary);
            font-size: 0.9em;
        }

        .item-period {
            font-size: 0.8em;
            color: #666;
            background: #f0f0f0;
            padding: 3px 6px;
            border-radius: 3px;
        }

        .item-body {
            margin-bottom: 8px;
        }

        .item-system {
            color: var(--secondary);
            font-size: 0.9em;
            margin-bottom: 4px;
        }

        .item-activity {
            font-size: 1em;
            color: #333;
        }

        .item-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 8px;
            font-size: 0.8em;
            color: #666;
        }

        .item-actions {
            display: flex;
            gap: 5px;
        }

        .btn {
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 0.9em;
        }

        .btn-success {
            background-color: var(--success);
        }

        .btn-danger {
            background-color: var(--danger);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 400px;
        }

        @media (min-width: 768px) {
            body {
                font-size: 16px;
                padding: 20px;
            }
            
            .item {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Checklist de Manutenção Predial</h1>
        
        <div class="filters">
            <select id="system-filter">
                <option value="">Todos Sistemas</option>
                <option value="Hidrossanitário">Hidrossanitário</option>
                <option value="Incêndio">Proteção Incêndio</option>
                <option value="Elétrico">Elétrico</option>
                <option value="Climatização">Climatização</option>
                <option value="Estrutural">Estrutural</option>
            </select>
            
            <select id="period-filter">
                <option value="">Todas Periodicidades</option>
                <option value="DIÁRIA">Diária</option>
                <option value="SEMANAL">Semanal</option>
                <option value="MENSAL">Mensal</option>
                <option value="TRIMESTRAL">Trimestral</option>
                <option value="SEMESTRAL">Semestral</option>
                <option value="ANUAL">Anual</option>
            </select>
            
            <button id="reset">Limpar Filtros</button>
        </div>

        <div id="checklist">
            <!-- Itens serão inseridos aqui -->
        </div>
    </div>

    <div id="modal" class="modal">
        <div class="modal-content">
            <h3 id="modal-title"></h3>
            <p id="modal-message"></p>
            <button onclick="closeModal()" class="btn" style="width: 100%; margin-top: 15px;">OK</button>
        </div>
    </div>

    <script>
        // Dados completos baseados no PDF
        const maintenanceItems = [
            // Sistema Hidrossanitário
            { id: "A16", periodicity: "SEMESTRAL", system: "Hidrossanitário", activity: "Verificar estanqueidade de registros e componentes", responsible: "Manutenção Local" },
            { id: "A17", periodicity: "ANUAL", system: "Hidrossanitário", activity: "Substituir vedantes de torneiras e registros", responsible: "Empresa Especializada" },
            { id: "A33", periodicity: "MENSAL", system: "Hidrossanitário", activity: "Verificar mecanismos da caixa acoplada", responsible: "Manutenção Local" },
            
            // Sistema de Incêndio
            { id: "B2.7", periodicity: "ANUAL", system: "Incêndio", activity: "Recarregar extintores", responsible: "Empresa Especializada" },
            { id: "B6.3", periodicity: "MENSAL", system: "Incêndio", activity: "Testar sistema de hidrantes", responsible: "Manutenção Local" },
            
            // Sistema Elétrico
            { id: "C1.0", periodicity: "DIÁRIA", system: "Elétrico", activity: "Verificar quadros elétricos", responsible: "Manutenção Local" },
            { id: "C2.6", periodicity: "SEMESTRAL", system: "Elétrico", activity: "Testar disjuntores DR", responsible: "Empresa Certificada" },
            
            // Climatização
            { id: "E1.3", periodicity: "MENSAL", system: "Climatização", activity: "Limpar filtros de ar-condicionado", responsible: "Técnico Especializado" },
            
            // Estrutural
            { id: "IID10", periodicity: "QUINQUENAL", system: "Estrutural", activity: "Verificar tirantes e estrutura", responsible: "Engenharia Especializada" }
        ];

        let savedData = JSON.parse(localStorage.getItem('maintenanceData')) || {};

        function renderItems() {
            const container = document.getElementById('checklist');
            container.innerHTML = '';
            
            const now = new Date();
            const systemFilter = document.getElementById('system-filter').value;
            const periodFilter = document.getElementById('period-filter').value;

            maintenanceItems.forEach(item => {
                if (systemFilter && item.system !== systemFilter) return;
                if (periodFilter && item.periodicity !== periodFilter) return;

                const itemKey = item.id;
                const itemData = savedData[itemKey] || {};
                const lastDone = itemData.lastDone ? new Date(itemData.lastDone) : null;
                const nextDue = lastDone ? calculateNextDue(lastDone, item.periodicity) : null;
                const isOverdue = nextDue ? now > nextDue : true;

                const itemElement = document.createElement('div');
                itemElement.className = `item ${itemData.status === 'completed' ? 'completed' : ''} ${isOverdue ? 'overdue' : ''}`;
                
                itemElement.innerHTML = `
                    <div class="item-header">
                        <span class="item-id">${item.id}</span>
                        <span class="item-period">${formatPeriodicity(item.periodicity)}</span>
                    </div>
                    <div class="item-body">
                        <div class="item-system">${item.system}</div>
                        <div class="item-activity">${item.activity}</div>
                    </div>
                    <div class="item-footer">
                        <span>${item.responsible}</span>
                        <div class="item-actions">
                            <button class="btn btn-success" onclick="completeItem('${item.id}', '${item.periodicity}')">✓</button>
                            <button class="btn btn-danger" onclick="skipItem('${item.id}')">✗</button>
                        </div>
                    </div>
                    ${lastDone ? `<div class="item-history">Última: ${formatDate(lastDone)}</div>` : ''}
                `;

                container.appendChild(itemElement);
            });
        }

        function calculateNextDue(lastDate, periodicity) {
            const nextDate = new Date(lastDate);
            switch(periodicity) {
                case 'DIÁRIA': nextDate.setDate(nextDate.getDate() + 1); break;
                case 'SEMANAL': nextDate.setDate(nextDate.getDate() + 7); break;
                case 'MENSAL': nextDate.setMonth(nextDate.getMonth() + 1); break;
                case 'TRIMESTRAL': nextDate.setMonth(nextDate.getMonth() + 3); break;
                case 'SEMESTRAL': nextDate.setMonth(nextDate.getMonth() + 6); break;
                case 'ANUAL': nextDate.setFullYear(nextDate.getFullYear() + 1); break;
            }
            return nextDate;
        }

        function formatDate(date) {
            return date.toLocaleDateString('pt-BR', { 
                day: '2-digit', 
                month: '2-digit', 
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function formatPeriodicity(period) {
            const map = {
                'DIÁRIA': 'Diária',
                'SEMANAL': 'Semanal',
                'MENSAL': 'Mensal',
                'TRIMESTRAL': 'Trimestral',
                'SEMESTRAL': 'Semestral',
                'ANUAL': 'Anual',
                'QUINQUENAL': '5 Anos'
            };
            return map[period] || period;
        }

        function showModal(title, message) {
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-message').textContent = message;
            document.getElementById('modal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
        }

        function completeItem(id, periodicity) {
            const now = new Date();
            const nextDue = calculateNextDue(now, periodicity);
            
            savedData[id] = {
                status: 'completed',
                lastDone: now.toISOString(),
                nextDue: nextDue.toISOString()
            };
            
            localStorage.setItem('maintenanceData', JSON.stringify(savedData));
            
            showModal(
                'Concluído com Sucesso!',
                `Próxima verificação: ${formatDate(nextDue)}\n\nVerifique se:\n1. Todas etapas foram executadas\n2. Não há vazamentos/resíduos\n3. Sistemas estão operando normalmente`
            );
            
            renderItems();
        }

        function skipItem(id) {
            if (confirm('⚠️ Atenção!\nPular esta inspeção pode causar:\n- Riscos de segurança\n- Danos estruturais\n- Multas regulatórias\n\nConfirma a exclusão?')) {
                savedData[id] = {
                    status: 'skipped',
                    lastSkipped: new Date().toISOString()
                };
                localStorage.setItem('maintenanceData', JSON.stringify(savedData));
                renderItems();
            }
        }

        // Event Listeners
        document.getElementById('system-filter').addEventListener('change', renderItems);
        document.getElementById('period-filter').addEventListener('change', renderItems);
        document.getElementById('reset').addEventListener('click', () => {
            document.getElementById('system-filter').value = '';
            document.getElementById('period-filter').value = '';
            renderItems();
        });

        // Initial Render
        renderItems();
    </script>
</body>
</html>